\section{Review Questions}

\subsection{Scanning}
\begin{itemize}
    \item In the SYN scan; Nmap will send a SYN message to the target. What is the response if the port is open or closed?
    \begin{enumerate}
        \item Open: A SYN/ACK packet
        \item Closed A RST packet
        \item Filtered: No response given
    \end{enumerate}
    \item Active banner grabbing techniques used by an attacker to determine the OS running on a remote target system.
    \begin{itemize}
        \item TCP Sequence ability test
        \item Port Unreachable
    \end{itemize}
    \item Passive banner grabbing techniques:
    \begin{itemize}
        \item Banner grabbing from error messages
        \item Sniffing the network traffic
        \item Banner grabbing from page extensions
    \end{itemize}
    \item Countermeasures to prevent information disclosure through banner grabbing
    \begin{itemize}
        \item \textbf{Display false banners to mislead or deceive attackers.}
        \item Turn off unnecessary services on the network host to limit information disclosure.
        \item Disabling open relay feature protect from SMTP enumeration.
        \item Disabling the DNS zone transfers to untrusted hosts protect from DNS enumeration
        \item Restricting anonymous access through RestrictNullSessAccess parameter from the Windows Registry protects from SMB enumeration.
    \end{itemize}
\end{itemize}

\subsection{Chapter 4: Enumeration}
\subsubsection{Enumeration Concepts}
\begin{enumerate}
    \item Which of the following enumeration techniques does an attacker take advantage of different error messages generated during the service authentication process?
    \begin{itemize}
        \item \textbf{Brute-force Active Directory}
        \item Extract usernames using SNMP: attackers guess read-only or read-write community strings by using SNMP API to extract usernames.
        \item Extract usernames using email IDs: emails contain a username and a domain name.
        \item Extract information using default passwords
    \end{itemize}
\end{enumerate}

\subsection{Chapter 5: System Hacking}
\subsubsection{Escalating Privaleges}
\begin{itemize}
    \item A pen tester is using Metasploit to exploit an FTP server and pivot to a LAN. How will the pen tester pivot using Metasploit?
    \begin{itemize}
        \item Create a route statement in the meterpreter.
    \end{itemize}
\end{itemize}
\subsubsection{Maintaining Access}


\subsection{Sniffing}
\subsubsection{Sniffing Concepts}
\begin{itemize}
    \item Which of the following OSI layers do sniffers operate and perform an initial compromize?
    \begin{itemize}
        \item Data link layer: the second layer of the OSI model. Data packets are encoded and decoded into bits. OSI layers are designed to work independently of each other; thus if a sniffer sniffs data in the data link layer, the upper OSI layers will not be aware of the sniffing.
    \end{itemize}
    \item Which of the following techniques is also a type of netowkr protocol used for PNAC that is used to defend against MAC address spoofing and to enforce access control at the point where a user joins a network.
    \begin{itemize}
        \item \textbf{Implementation of IEEE 802.1X Suites}: This is a type of network protocol for port-based Network Access control (PNAC), and its main purpose is to enforce access control at the point where a user joins the network.
        \item DCHP Snooping Binding Table: DHCP snooping process filters untrusted DHCP messages and helps to build and bind a DHCP binding table. This table contains the MAC address, IP address, lease time, binding type, CLAN number, and interface information to correspond with untrusted interfaces of a switch. It acts as a firewall between untrusted hosts and DHCP servers. It also helps in differentiating between trusted and untrusted interfaces.
        \item Dynamic ARP Inspection: The system checks the IP-MAC address binding for each ARP packet in a network. While performing a DAI, the system will automatically drop invalid IP-MAC address binding.
        \item IP Source Guard: IP source gurad is a security feature in switches that restricts the IP traffic on untrusted layer 2 ports by filtering traffic based on the DHCP snooping binding database. It prevents spoofing attacks when the attacker tries to spoof or use the IP address of another host. 
    \end{itemize}
    \item Which of the following Cisco switch port configuration commands is used to enter a secure MAC address for the interface and the maximum number of secure MAC addresses?
    \begin{itemize}
        \item \verb|switchport port-security mac-address mac_address|: Enters a secure MAC address for the interface. You can use this command to enter the maximum number of secure MAC addreses.
        \item \verb|switchport port-security limit rate invalid-source-max|: sets the rate limit for bad packets.
        \item \verb|switchport port-security maximum value|: Sets the maximum number of secure MAC addresses for the interface. The range is 1 to 3072; the default is 1.
        \item \verb|switchport port-security mac-address sticky| Enables sticky learning on the interface.
    \end{itemize}
    \item Which of the following techniques enables devices to detect the existence of unidirectional links and disable the affected interfaces in the network, in addition to causing STP topology loops.
    \begin{itemize}
        \item \textbf{UDLD (Unidirectional Link Detection)}: def in question
        \item BPDU Guard: BPDU guard must be enabled on the ports that should never recieve a BPDU from their connected devices. This is used to avoid the transimission of BPDUs on PortFast-enabled ports. This feature helps in preventing potential bridging loops in the network.
        \item Root Guard: Protects the root bridge and ensures that it remains as the root in the STP topology. It forces the interfaces to become the designaged ports (forwarding ports) to prevent the nearby switches from becoming root switches.
        \item Loop Guard: Loop guard improves the stability of the network by preventing it against the bridging loops. it is generally used to protect against a malformed switch.
    \end{itemize}
    \item Which of the following IPv4 DHCP packet fields inculdes random number chosen by a client to associate request messages and their responses between the client and server?
    \begin{itemize}
        \item Opcode: 1 octet, contains the message opcode that represents the message type: opcode "1" represents messages sent by the client, while "2" represents responses sent by the server.
        \item \textbf{Transaction ID (XID)}: 4 Octets, a random number is chosen by the client to associate the request messages and their responses between a client and a server.
        \item Flags: 2 octets, Flags set by the client; For example, if the client cannot recieve unicast IP datagrams, then the broadcast flag is set.
        \item Server Name (SNAME): 64 octets, Optional server hostname.
    \end{itemize}
    \item Which of the following IOS global commands verifies the DHCP snooping configuration?
    \begin{itemize}
        \item \verb|show ip dhcp spoofing|: Verifies the configuration.
        \item \verb|ip dhcp snooping|: Enables DHCP snooping globally.
        \item \verb|ip dhcp snooping trust|: Configures the interface as trusted or untrusted.
        \item \verb|no ip dhcp snooping information option|: To disable the insertion and the removal of the option-82 field, use the no ip dhcp snooping information option in global configuration command.
    \end{itemize}
    \item In which of the following attacks does an attacker send spoofed router advertisement messages so that all the data packets travel through thri system to collect valuble information and launch MITM and DoS attacks?
    \begin{itemize}
        \item \textbf{IRDP Spoofing}: An attacker can use this to send spoofed router advertisement messages so that all the data packets travel through the attacker;s system. Thus, the attacker can sniff the traffic and collect valuble information from the data packets. Attackers can use IRDP spoofing to launch MITM, DoS and passive sniffing attacks.
        \item MAC Spoofing: in this attack, the attacker first retrieves the MAC addresses of clients who are actively associated with the switch port. Then, the attacker spoofs a MAC address with the MAC address of the legitimate client. If the spoofing is successful, then the attacker can recieve all the traffic destined for the client. Thus, an attacker can gain access to the network and take over the identity of someone on the network.
        \item ARP Spoofing Attack: ARP spoofing is a method of attacking an Ethernet LAN. When a legitimate user initiates a session with another user in the same layer 2 broadcast domain, the switch broadcasts an ARP request using the recipient's IP address, while the sender waits for the recipient to respond with a MAC address. An attacker eavesdropping on this unprotected layer 2 broadcast domain can respond to the broadcast ARP request and replies to the sender by spoofing the intended recipient's IP address.
        \item STP Attack: If an attacker has access to two switches, he/she introduces a rogue switch in the network with a priority lower than any other switch in the network. This makes the rogue switch the root bridge, thus allowing the attacker to sniff all the traffic flowing in the network.
    \end{itemize}
    \item In one of the following techniques, an attacker must be connected to a LAN to sniff packets, and on successful sniffing, they can send a malicious reply to the sender before the actual DNS server.
    \begin{itemize}
        \item \textbf{Intranet DNS Spoofing}: An attacker can perform an intranet DNS spoofing attack on a switched LAN with the help of the ARP poisoning technique. To perform this attack, the attacker must be connected to the LAN and be able to sniff the traffic or packets. An attacker who succeeds in sniffing the ID of the DNS request from the intranet can send a malicious reply to the sender before the actual DNS server.
        \item  DNS Cache poisoning: DNS cache poisoning refers to altering or adding forged DNS records in the DNS resolver cache so that a DNS query is redirected to a malicious site. The DNS system uses cache memory to hold the recently resolved domain names.
        \item Proxy Server DNS Poisoning: In the proxy server DNS poisoning technique, the attacker sets up a proxy server on the attacker's system. The attacker also configures a fraudulent DNS and makes its IP address a primary DNS entry in the proxy server. The attacker changes the proxy server settings of the victim with the help of a Trojan. The proxy serves as a primary DNS and redirects the victim's traffic to the fake website, where the attacker can sniff the confidential information of the victim and then redirect the request to the real website.
        \item Internet DNS Spoofing: Internet DNS poisoning is also known as remote DNS poisoning. Attackers can perform DNS spoofing attacks on a single victim or on multiple victims anywhere in the world. To perform this attack, the attacker sets up a rogue DNS server with a static IP address.
    \end{itemize}
    \item Which of the following is not a mitigation technique against MAC address spoofing?
    \begin{itemize}
        \item \textbf{DNS security (DNSSEC)}: Implement Domain Name System Security Extension to prevent DNS spoofing attacks.
        \item 
    \end{itemize}
\end{itemize}

\subsubsection{Sniffing Tools and countermeasures}
\begin{itemize}
    \item What is the correct pcap filter to capture all transmission control protocol (TCP) traffic going to or from host 192.168.0.125 on port 25?
    \begin{itemize}
        \item tcp.port == 25 and ip.addr == 192.168.0.125
    \end{itemize}
\end{itemize}

\subsection{Social Engineering}
\subsubsection{Social Engineering Concepts}
\begin{itemize}
    \item Mat, a software engineer, received an email from his colleague John, stating that project files were missing from his system and asking Mat to send them to his personal email. Mat was suspicious and called John on his personal number. To his surprise, John replied that he has never written an email recently to Mat.\\ Which of the following types of attacks was Mat subjected to?
    \begin{itemize}
        \item \textbf{Intimidation}
    \end{itemize}
\end{itemize}
\subsubsection{Social Engineering Techniques}
\begin{itemize}
    \item A consultant is hired to do a physical penetration test at a large financial company. On the first day of his assessment, the consultant goes to the company's building dressed as an electrician and waits in the lobby for an employee to pass through the main access gate, and then the consultant follows the employee behind to get into the restricted area. Which type of attack did the consultant perform?
    \begin{itemize}
        \item \textbf{Tailgating} implies access to enter into the building or secured area without the consent of the authorized person. It is the act of following an authorized person through a secure entrance, as when a polite user opens and then holds the door for those following. An attacker wears a fake badge and attempts to enter a secured area by closely following an authorized person through a door requiring key access. He/she can then try to get into restricted areas by pretending to be an authorized person.
    \end{itemize}
\end{itemize}


\subsection{Denial-of-Service}
\subsubsection{DoS/DDoS Concepts}
% \begin{itemize}
%     \item 
% \end{itemize}
\subsubsection{DoS/DDoS Attack Techniques and Tools}
\begin{itemize}
    \item When a client's computer is infected with malicious software which connects to the remote computer to receive commands, the remote computer is called \_\_\_\_\_\_\_\_\_\_\_.
    \begin{itemize}
        \item Answer is C\&C, which will instruct the Bot what to do. When a client's computer is infected with malicious software which connects to the remote computer to receive commands, the remote computer is called C\&C. Bot and Botnet respectively represent infected computer and network of the infected computers managed by C\&C and server is not used in this terminology.
    \end{itemize}
    \item The DDoS tool used by anonymous in the so-called Operation Payback is called \_\_\_\_\_\_\_.
    \begin{itemize}
        \item LOIC is the first version of the tool and it was used in Operation Payback. HOIC is the second version of the tool with some additional features, and it was used in the Operation Megaupload. BanglaDos and Dereil do not have direct connection with anonymous group.
    \end{itemize}
\end{itemize}
\subsubsection{DoS/DDoS Protection Tools and Countermeasures}
\begin{itemize}
    \item What is the DoS/DDoS countermeasure strategy to at least keep the critical services functional?
    \begin{itemize}
        \item Degrading services: During an attack, if it is not possible to keep all the services functioning, then it is a good idea to keep at least the critical services functional. To do this, first, identify the critical services and then customize the network, systems, and application designs to cut down on the noncritical services. This may help you to keep the critical services functional.
    \end{itemize}
    \item Ivan works as security consultant at “Ask Us Intl.” One of his clients is under a large-scale volume-based DDoS attack, and they have to decide how to deal with the issue. They have some DDoS appliances that are currently not configured. They also have a good communication channel with providers, and some of the providers have fast network connections. In an ideal scenario, what would be the best option to deal with this attack. Bear in mind that this is a volume-based DDoS attack with at least 1 000 000 bots sending the traffic from the entire globe!
    \begin{itemize}
        \item The answer is “Absorb the attack,” since this is a really large volume of traffic, and using additional capacity (DDoS appliances that are currently not configured) to absorb the attack. Most of the other options are not practically feasible. Blocking the traffic at the provider level is a viable option, but in this case, since the attack cannot be easily filtered (Since the traffic coming from the entire globe), this is not an apt solution. Filtering the traffic at the provider level is the same thing as blocking the traffic at the provider level, so this is not a correct answer and filtering the traffic at the company's Internet facing routers option will not work because the traffic is already there, and in this case, it is impossible to do anything at the client's site.
    \end{itemize}
    \item John's company is facing a DDoS attack. While analyzing the attack, John has learned that the attack is originating from the entire globe, and filtering the traffic at the Internet Service Provider's (ISP) level is an impossible task to do. After a while, John has observed that his personal computer at home was also compromised similar to that of the company's computers. He observed that his computer is sending large amounts of UDP data directed toward his company's public IPs.

    John takes his personal computer to work and starts a forensic investigation. Two hours later, he earns crucial information: the infected computer is connecting to the C\&C server, and unfortunately, the communication between C\&C and the infected computer is encrypted. Therefore, John intentionally lets the infection spread to another machine in his company's secure network, where he can observe and record all the traffic between the Bot software and the Botnet. After thorough analysis he discovered an interesting thing that the initial process of infection downloaded the malware from an FTP server which consists of username and password in cleartext format. John connects to the FTP Server and finds the Botnet software including the C\&C on it, with username and password for C\&C in configuration file. What can John do with this information?
    \begin{itemize}
        \item The correct answer is “neutralize handlers,” because with admin's access to C\&C John can stop the attack, disable the C\&C software, and/or change the password to stop the DDoS attack on his company's network. Deflect the attack and mitigate the attack are not the correct answers because in both these cases, he is literally stopping the attack. Protect secondary victims is not the correct answer because secondary victims are still infected.
    \end{itemize}
    \item After successfully stopping the attack against his network, and informing the CERT about the Botnet and new password which he used to stop the attack and kick off the attackers from C\&C, John starts to analyze all the data collected during the incident and creating the so-called “Lessons learned” document. What is John doing?
    \begin{itemize}
        \item John is trying the postattack forensics in order to learn how to fight this type of attacks in the future. John is not trying to neutralize the handlers because this requires some type of access to C\&C, which was already done, and he is not trying to prevent potential attacks and protect secondary victims—this was already done in previous steps.
    \end{itemize}
\end{itemize}


\subsection{Session Hijacking}
\subsubsection{Session Hijacking Concepts}
\begin{itemize}
    \item 
\end{itemize}
\subsubsection{Application Level Session Hijacking}"
\begin{itemize}
    \item
\end{itemize}
\subsubsection{Network Level Session Hijacking}
\begin{itemize}
    \item In order to hijack TCP traffic, an attacker has to understand the next sequence and the acknowledge number that the remote computer expects. Explain how the sequence and acknowledgment numbers are incremented during the 3-way handshake process.
    \begin{itemize}
        \item During the 3-way handshake, sequence and acknowledgment numbers are (relatively) incremented by one. After that acknowledge number will be incremented for the size of the packet received.
    \end{itemize}
    \item Maira wants to establish a connection with a server using the three-way handshake. As a first step she sends a packet to the server with the SYN flag set. In the second step, as a response for SYN, she receives packet with a flag set.

    Which flag does she receive from the server?
    \begin{itemize}
        \item In the second step, the server sends a response to her with the SYN + ACK flag and an ISN (Initial Sequence Number) for the server.
        In the third step, Maira sets the ACK flag acknowledging the receipt of the packet and increments the sequence number by 1.
    \end{itemize}
\end{itemize}
\subsubsection{Session Hijacking Tools}
\begin{itemize}
    \item Marin was using sslstrip tool for many yearsagainst most of the websites, like Gmail, Facebook, Twitter, etc. He was supposed to give a demo on internet (in)security and wanted to show a demo where he can intercept 302 redirects between his machine and Gmail server. But unfortunately it does not work anymore. He tried the same on Facebook and Twitter and the result was the same. He then tried to do it on the company OWA (Outlook Web Access) deployment and it worked! He now wants to use it against Gmail in his demo because CISO thinks that security through obscurity is a best way to a secure system (obviously BAD CISO) and demonstrating something like that on company live system is not allowed. How can Marin use sslstrip or similar tool to strip S from HTTP?
    \begin{itemize}
        \item HSTS protection is basically the cookie that the website issues to the web browser, when user visits the website for the first time. It's long term cookie, which means that it will not expire. If the cookie is set - web browser prevents visiting the website over HTTP connection. So, by using sslstrip+ with dnsspoof module, one can effectively combat the protection if the user NEVER visited this website before. That's why he has to use IE in InPrivate browsing mode because it will not read the HSTS cookie. This is NOT the case with Firefox or Chrome though!
        SslstripHSTS tool does not exist.
    \end{itemize}
\end{itemize}
\subsubsection{Session Hijacking Countermeasures}
\begin{itemize}
    \item Which of the following countermeasures should be followed to defend against session hijacking?
    \begin{itemize}
        \item Use HTTP Public Key Pinning (HPKP) to allow users to authenticate web servers
    \end{itemize}
    \item Which of the following techniques mitigates the risk of ARP spoofing and other session hijacking attacks caused when using a hub network?
    \begin{itemize}
        \item \textbf{Switch Netowrk}: Mitigates the risk of ARP spoofing and other session hijacking attacks.
    \end{itemize}
    \item Which of the following techniques protects the client-server communication against session hijacking attacks by creating a public-private key pair for every connection to a remote server?
    \begin{itemize}
        \item Token Binding
    \end{itemize}
\end{itemize}


\subsection{Evading IDS, Firewalls, and Honeypots}
\subsubsection{IDS, IPS, Firewall and Honeypot Concepts}
\begin{itemize}
    \item Which of the following attributes in a packet can be used to check whether the packet originated from an unreliable zone?
    \begin{itemize}
        \item Source IP address
    \end{itemize}
    \item What is the main advantage that a network-based IDS/IPS system has over a host-based solution?
    \begin{itemize}
        \item They do not use host system resources. Host-based intrusion detection systems (IDSes) protect just that: the host or endpoint. This includes workstations, servers, mobile devices and the like. Host-based IDSes are not just one of the last layers of defense, but they're also one of the best security controls because they can be fine-tuned to the specific workstation, application, user role or workflows required. A network-based IDS often sits on the ingress or egress point(s) of the network to monitor what's coming and going. Given that a network-based IDS sits further out on the network, so it doesn't use any host system resources and it may not provide enough granular protection to keep everything in check -- especially for network traffic that's protected by SSL, TLS or SSH.
    \end{itemize}
    \item Which of the following is a hardware requirement that either an IDS/IPS system or a proxy server must have in order to properly function?
    \begin{itemize}
        \item They must be Dual-homed. Dual-homed devices have two interfaces; a public interface that directly connected to the Internet and a private interface connected to the Intranet. It is a hardware requirement that either an IDS/IPS system or a proxy server must have in order to properly function. The bastion host is an example of dual-homed system designed for defending the network against attacks. It acts as a mediator between inside and outside networks. A bastion host is a computer system designed and configured to protect network resources from attack. Traffic entering or leaving the network passes through the firewall.
    \end{itemize}
    \item Which of the following descriptions is true about a static NAT?
    \begin{itemize}
        \item A static NAT uses a one-to-one mapping.
    \end{itemize}
    \item Jamie needs to keep data safe in a large datacenter, which is in desperate need of a firewall replacement for the end of life firewall. The director has asked Jamie to select and deploy an appropriate firewall for the existing datacenter. The director indicates that the amount of throughput will increase over the next few years and this firewall will need to keep up with the demand while other security systems do their part with the passing data. What firewall will Jamie use to meet the requirements?
    \begin{itemize}
        \item Performance is the key focus of the question; therefore, the test taker will have to focus on the real need of the most enterprise businesses and not get distracted by other slower firewall types. Packet filtering firewall may seem old school to less experienced test takers and they may immediately choose other options.
        Packet filtering firewalls are best performing of the choices.
    \end{itemize}
    \item When analyzing the IDS logs, the system administrator notices connections from outside of the LAN have been sending packets where the source IP address and destination IP address are the same. However, no alerts have been sent via email or logged in the IDS. Which type of an alert is this?
    \begin{itemize}
        \item False Negative
    \end{itemize}
    \item When analyzing the IDS logs, the system administrator noticed an alert was logged when the external router was accessed from the administrato's computer to update the router configuration. What type of an alert is this?
    \begin{itemize}
        \item False Positive
    \end{itemize}
    \item At which two traffic layers do most commercial IDSes generate signatures? (Select Two)
    \begin{itemize}
        \item According to New 'semantics-aware' IDS reduces false positives (https://searchsecurity.techtarget.com/news/1113940/New-semantics-aware-IDS-reduces-false-positives), https://www.sanfoundry.com/computer-networks-questions-answers-entrance-exams/, and https://searchsecurity.techtarget.com/quiz/Quiz-IDS-IPS, the most commercial IDSes generate signatures at the network and transport layers.
    \end{itemize}
\end{itemize}
\subsubsection{IDS, IPS, Firewall, and Honeypot Solutions}
\begin{itemize}
    \item When an alert rule is matched in a network-based IDS like snort, the IDS does which of the following:
    \begin{itemize}
        \item   Continues to evaluate the packet until all rules are checked
    \end{itemize}
\end{itemize}
\subsubsection{Evading IDS}
\begin{itemize}
    \item How many bit checksum is used by the TCP protocol for error checking of the header and data and to ensure that communication is reliable?
    \begin{itemize}
        \item  16-bitwa
    \end{itemize}
    \item An attacker hides the shellcode by encrypting it with an unknown encryption algorithm and by including the decryption code as part of the attack packet. He encodes the payload and then places a decoder before the payload. Identify the type of attack executed by attacker.
    \begin{itemize}
        \item Polymorphic Shellcode
    \end{itemize}
\end{itemize}
\subsubsection{Evading Firewalls}
\begin{itemize}
    \item Which of the following attack techniques is used by an attacker to exploit the vulnerabilities that occur while processing the input parameters of end users and the server responses in a web application?
    \begin{itemize}
        \item XSS attack
    \end{itemize}
    \item Which of the following techniques is used by attackers for collecting information about remote networks behind firewalls, where the TTL value is used to determine ACL gateway filters and map networks by analyzing the IP packet response?
    \begin{itemize}
        \item Firewalking
    \end{itemize}
    \item Firewalk has just completed the second phase (the scanning phase) and a technician receives the output shown below.
    What conclusions can be drawn based on these scan results?
    \begin{itemize}
        \item TCP port 21—no response
        \item TCP port 22—no response
        \item TCP port 23—Time-to-live exceeded
    \end{itemize}
    \begin{itemize}
        \item The scan on port 23 passed through the filtering device. This indicates that port 23 was not blocked at the firewall.
    \end{itemize}
    \item Which feature of Secure Pipes tool open application communication ports to remote servers without opening those ports to public networks?
    \begin{itemize}
        \item Local forwards open application communication ports to remote servers without opening those ports to public networks. It brings the security of VPN communication to clients and servers on an ad hoc basis without the configuration and management hassle.
    \end{itemize}
\end{itemize}
\subsubsection{Honeypot, IDS, and Firewall Evasion Countermeasures}
\begin{itemize}
    \item In what way do the attackers identify the presence of layer 7 tar pits?
    \begin{itemize}
        \item By looking at the latency of the response from the service.
    \end{itemize}
    \item Which of the following methods is NOT a countermeasure to defend against IDS evasions?
    \begin{itemize}
        \item Never define the DNS server for client resolver in routers
    \end{itemize}
    \item Which of the following countermeasures can be employed to defend against firewall evasion?
    \begin{itemize}
        \item Following are some of the countermeasures to defend against firewall Evasion:
        \begin{itemize}
            \item By default, disable all FTP connections to or from the network
            \item Set the firewall rule set to deny all traffic and enable only the services required.
            \item Specify the source and destination IP addresses as well as the ports.
            \item Notify the security policy administrator about firewall changes and document them
            \item Monitor user access to firewalls and control who can modify the firewall configuration
            \item Take regular backups of the firewall rule set and configuration files
            \item Configure a remote syslog server and adopt strict measures to protect it from malicious users.
            \item Schedule regular firewall security audits.
            \item The firewall should be configured such that the IP address of an intruder should be filtered out.
        \end{itemize}
    \end{itemize}
\end{itemize}

\subsection{Hacking Web Servers}
\subsubsection{Web Server Concepts}
\begin{itemize}
    \item Which of the following types of damage is caused when attackers access sensitive data such as financial records, future plans, and the source code of a program?
    \begin{itemize}
        \item Data Theft
    \end{itemize}
\end{itemize}
\subsubsection{Web Server Attacks}
\begin{itemize}
    \item In which of the following attack types does an attacker exploit the trust of an authenticated user to pass malicious code or commands to a web server?
    \begin{itemize}
        \item Cross-site request forgery
    \end{itemize}
    \item In which of the following attacks does an attacker attempt to access sensitive information by intercepting and altering communications between an end user and a web server?
    \begin{itemize}
        \item Man-in-the-Middle attack.
    \end{itemize}
    \item If an attacker compromises a DNS server and changes the DNS settings so that all the requests coming to the target webserver are redirected to his/her own malicious server, then which attack did he perform?
    \begin{itemize}
        \item DNS server hijacking
    \end{itemize}
\end{itemize}
\subsubsection{Web Server Attack Methodology}
\begin{itemize}
    \item Which of the following tools is not used to perform webserver information gathering?
    \begin{itemize}
        \item Among the options, Nmap, Netcraft and Whois are the tools used to perform footprinting of webservers, whereas \textbf{Wireshark} is a network sniffing tool.
    \end{itemize}
    \item Which of the following command does an attacker use to enumerate common web applications?
    \begin{itemize}
        \item \verb|nmap --script http-enum -p80 <host>|
    \end{itemize}
    \item Atatcker use GET and CONNECT requests to use vulnerable web servers as which of the following?
    \begin{itemize}
        \item Sometimes, web servers are configured to perform functions such as forwarding or reverse HTTP proxy. Web servers with these functions enabled are employed by the attackers to perform following attacks:
        \begin{itemize}
            \item Attacking third-party systems on internet
            \item Connecting to arbitrary hosts on the organization's internal network
            \item Connecting back to other services running on the proxy host itself
        \end{itemize}
        Attackers use GET and CONNECT requests to use vulnerable web servers as proxies to connect and obtain information from target systems through these proxy web servers.
    \end{itemize}
    \item Which of the following types of payload modules in the Metasploit framework is self-contained and completely stand-alone?
    \begin{itemize}
        \item Singles
    \end{itemize}
\end{itemize}
\subsubsection{Web Server Attack Countermeasures}
\begin{itemize}
    \item Which of the following guidelines should be followed by application developers to defend against HTTP response-splitting attacks?
    \begin{itemize}
        \item Parse all user inputs or other forms of encoding before using them in HTTP headers
    \end{itemize}
    \item Which of the following is NOT a best approach to protect your firm against web server attacks?
    \begin{itemize}
        \item Allow remote registry Administration.
        \item To defend web servers and provide security, you must remove unnecessary ISAPI filters from the web server, apply restricted ACLs, secure the SAM (stand-alone servers only), and block the remote registry administration.
    \end{itemize}
    \item Choose an ICANN accredited registrar and encourage them to set registrar-lock on the domain name in order to avoid which attack?
    \begin{itemize}
        \item DNS hijacking attack
    \end{itemize}
    \item Which on of the following techniques defends servers against blind response forgery?
    \begin{itemize}
        \item UDP source port randomization technique defends servers against blind response forgery. Limit the number of simultaneous recursive queries and increase the times-to-live (TTL) of legitimate records.
        Following are some of the methods to defend against HTTP response-splitting and web cache poisoning:
        Server Admin:
        Use latest web server software
        Regularly update/patch OS and web server
        Run web vulnerability scanner
        Application Developers:
        Restrict web application access to unique IPs
        Disallow carriage return (\verb|%0d or \r|) and line feed (\verb|%0a or \n|) characters
        Comply to RFC 2616 specifications for HTTP/1.1
    \end{itemize}
\end{itemize}
\subsubsection{Patch Management}
\begin{itemize}
    \item Which of the following is true for automated patch management process?
    \begin{itemize}
        \item In an automated patch management process, detect -> assess -> acquire -> test -> deploy -> maintain is the process that is followed
    \end{itemize}
\end{itemize}

\subsection{Web Applications}
\subsubsection{Web App Concepts}
\begin{itemize}
    \item 
\end{itemize}
\subsubsection{Web App Threats}
\begin{itemize}
    \item Which of the following is a security risk due to the incorrect implementation of applications, allowing attackers to compromise passwords, keys, session tokens, and exploit user identity?
    \begin{itemize}
        \item Broken authentication
    \end{itemize}
    \item In which of the following types of injection attacks does an attacker exploit vulnerable form inputs, inject HTML code into a webpage, and change the website appearance?
    \begin{itemize}
        \item HTML injection
    \end{itemize}
    \item Which of the following security misconfigurations supports weak algorithms and uses expired or invalid certificates, resulting in data exposure and account theft?
    \begin{itemize}
        \item Insufficient transport layer protection
    \end{itemize}
    \item Which of the following attacks allows an attacker to encode portions of the attack with Unicode, UTF-8, Base64, or URL encoding to hide their attacks and avoid detection?
    \begin{itemize}
        \item Obduscation Application
    \end{itemize}
    \item Which of the following is a timing attack performed by measuring the approximate time taken by a server to process a POST request so that the existence of a username can be deduced?
    \begin{itemize}
        \item Direct Timing Attack
    \end{itemize}
    \item Which of the following is an application security threat that occurs when an application includes untrusted data in a new web page without proper validation or escaping or when an application updates an existing web page with user-supplied data?
    \begin{itemize}
        \item Cross-site scripting (XSS)
    \end{itemize}
    \item Which of the following attacks exploits vulnerabilities in dynamically generated webpages, which enables malicious attackers to inject client-side scripts into webpages viewed by other users?
    \begin{itemize}
        \item Cross-site scripting
    \end{itemize}
    \item During a penetration test, a tester finds that the web application being analyzed is vulnerable to XSS. Which of the following conditions must be met to exploit this vulnerability?
    \begin{itemize}
        \item The session cookies do not have the HttpOnly flag set.
    \end{itemize}
    \item An attacker has been successfully modifying the purchase price of items purchased on the company's website. The security administrators verify the webserver and Oracle database have not been compromised directly. They have also verified the intrusion detection system (IDS) logs and found no attacks that could have caused this. What is the most likely way the attacker has been able to modify the purchase price?
    \begin{itemize}
        \item By changing hidden form values
    \end{itemize}
    \item Which of the following conditions must be given to allow a tester to exploit a cross-site request forgery (CSRF) vulnerable web application?
    \begin{itemize}
        \item The web application should not use random tokens.
    \end{itemize}
\end{itemize}
\subsubsection{Web App Hacking Methodology}
\begin{itemize}
    \item Which of the following HTTP service port numbers is used for connecting to a remote network server system?
    \begin{itemize}
        \item \textbf{384: Remote network Server System}
        \item 80: World Wide Web standard port
        \item 81: Alternate WWW
        \item 88: Kerberos
    \end{itemize}
    \item Which of the followings techniques is used by an attacker to enumerate usernames from a target web application?
    \begin{itemize}
        \item Verbose failure message
    \end{itemize}
    \item Which of the following attacks is possible when an attacker executes .bat or .cmd files and changes the values by superimposing one or more operating-system commands through the request?
    \begin{itemize}
        \item Parsing Attack
    \end{itemize}
    \item Which of the following automatically discover hidden content and functionality by parsing HTML form and client-side JavaScript requests and responses?
    \begin{itemize}
        \item Web Spiders
    \end{itemize}
    \item An attacker wants to exploit a webpage. From which of the following points does he start his attack process?
    \begin{itemize}
        \item Identify entry points for user input\\
        The first step in analyzing a web app is to check for the application entry point, which can later serve as a gateway for attacks. One of the entry points includes the front-end web app that intercepts HTTP requests. Other web app entry points are user interfaces provided by webpages, service interfaces provided by web services, serviced components, and .NET remoting components. Attackers should review the generated HTTP request to identify the user input entry points.
    \end{itemize}
\end{itemize}
\subsubsection{Web API, Webhooks and Web Shell}
\begin{itemize}
    \item Some of the best practices for securing webhooks are as follows:
    \begin{itemize}
        \item Use rate limiting on webhook calls in the web server to control the incoming and outgoing traffic
        \item Compare the request timestamp X-Cld-Timestamp of the webhook with the current timestamp to prevent timing attacks
        \item Validate the X-OP-Timestamp within the threshold of the current time
        \item Ensure that the event processing is idempotent to prevent event receipts replication
        \item Ensure that the webhook code responds with 200 OK (success) instead of 4xx or 5xx statuses in case of errors to ensure that the webhooks are not deactivated
        \item Ensure that the webhook URL supports the HTTP HEAD method to retrieve meta-information without transferring the entire content
        \item Use threaded requests to send multiple requests at the same time and to update data in the API rapidly
        \item Make sure that the tokens are stored against the store\_hash and not against the user data
    \end{itemize}
\end{itemize}
\subsubsection{Web App Security}
\begin{itemize}
    \item While performing data validation of web content, a security technician is required to restrict malicious input. Which of the following processes is an efficient way of restricting malicious input?
    \begin{itemize}
        \item Data validation is performed to ensure that the data is strongly typed, correct syntax, within length boundaries, contains only permitted characters, or that numbers are correctly signed and within range boundaries. So, while performing data validation of web content, a security technician is required to validate web content input for type, length, and range.
    \end{itemize}
\end{itemize}

\subsection{SQL Injection}
\subsubsection{SQL Injection Concpets}
\begin{itemize}
    \item Which of the following system table does MS SQL Server database use to store metadata? Hackers can use this system table to acquire database schema information to further compromise the database.
    \begin{itemize}
        \item sysobjects: contains a row for every object that has been created in the database, including stored procedures, views, and user tables.
    \end{itemize}
    \item Which of the following methods carries the requested data to the webserver as part of the message body?
    \begin{itemize}
        \item HTTP POST
    \end{itemize}
    \item Which of the following is the most effective technique in identifying vulnerabilities or flaws in the web page code?
    \begin{itemize}
        \item Code analysis
    \end{itemize}
\end{itemize}
\subsubsection{Types of SQL Injection}
\begin{itemize}
    \item What is the main difference between a "Normal" SQL injection and a "Blind" SQL injection vulnerability?
    \begin{itemize}
        \item The vulnerable application does not display errors with information about the injection results to the attacker.
    \end{itemize}
    \item In blined SQLi, attacker can steal data by asking a series of true or false questions through SQL statements. Select all the correct types of blind SQL injections.
    \begin{itemize}
        \item Time Delay
        \item Boolean exploitation.
    \end{itemize}
    \item Which of the following SQL queries is an example of a heavy query used in SQL injection?
    \begin{itemize}
        \item The following query in Oracle takes a huge amount of time to execute:\\
        \verb|SELECT count(*) FROM all_users A, all_users B, all_users C|
        \item If an attacker injects a malicious parameter to the above query to perform a time-based SQL injection without using functions, then it takes the following form:\\
        \verb|1 AND 1 < SELECT count(*) FROM all_users A, all_users B, all_users C|
        \item The final resultant query takes the form:\\
        \verb|SELECT * FROM products WHERE id=1 AND 1 < SELECT count(*) FROM all_users A, all_users B, all_users C|
    \end{itemize}
\end{itemize}
\subsubsection{SQL Injection Methodology}
\begin{itemize}
    \item Which of the following countermeasures allows developers to protect PL/SQL code from SQL injection attacks?
    \begin{itemize}
        \item Make use of bind parameters in dynamic SQL
    \end{itemize}
\end{itemize}
\subsubsection{SQL Injection Countermeasures}
\begin{itemize}
    \item Which of the following practices makes web applications vulnerable to SQL injection attacks?
    \begin{itemize}
        \item Database server running OS commands.
    \end{itemize}
    \item Which of the following commands has to be disabled to prevent exploitation at the OS level?
    \begin{itemize}
        \item The xp\_cmdshell option is an SQL server configuration option that enables system administrators to control whether the xp\_cmdshell extended stored procedure can be executed on a system. Disable commands such as xp\_cmdshell, as they can affect the OS of the system.
    \end{itemize}
    \item Which of the following is a Snort rule that is used to detect and block an SQL injection attack?
    \begin{itemize}
        \item Many of the common attacks use specific type of code sequences or commands that allow attackers to gain an unauthorized access to the target's system and data. These commands and code sequences allow a user to write Snort rules that aim to detect SQL injection attacks.
        \item Expression that can be blocked by Snort:
        \begin{itemize}
            \item \begin{verbatim}
                /(%27)|(\')|(\-\-)|(\%23)|(#)/ix
            \end{verbatim}
            \item \begin{verbatim}
                /exec(\s|\+)+(s|x)p\w+/ix
            \end{verbatim}
            \item \begin{verbatim}
                /((\%27)|(\'))((\%6F)|o|(\%4F))((\%72)|r|(\%52))/ix
            \end{verbatim}
            \item \begin{verbatim}
                alert tcp $EXTERNAL_NET and -> $HTTP_SERVERS $HTTP_PORTS (msg:"SQL Injection - Paranoid"; flow:to_server,established;uricontent:".pl";pcre:"/(\%27)|(\')|(\-\-)|(%23)|(#)/i";classtype:Web-application-attack;sid:9000;rev:5
            \end{verbatim}
        \end{itemize}
    \end{itemize}
\end{itemize}

\subsection{Hacking Wireless Networks}
\subsubsection{Wireless Concepts}
\begin{itemize}
    \item In LAN-to-LAN Wireless Network, the APs provide wireless connectivity to local computers, and computers on different networks that can be interconnected?
    \begin{itemize}
        \item True
    \end{itemize}
    \item In which of the following processes do the station and access point use the same WEP key to provide authentication, which means that this key should be enabled and configured manually on both the access point and the client?
    \begin{itemize}
        \item WEP encryption
    \end{itemize}
\end{itemize}
\subsubsection{Wireless Encryption}
\begin{itemize}
    \item 
\end{itemize}
\subsubsection{Wireless Threats}
\begin{itemize}
    \item 
\end{itemize}
\subsubsection{Wireless Hacking Methodology}
\begin{itemize}
    \item 
\end{itemize}
\subsubsection{Bluetooth Hacking}
\begin{itemize}
    \item 
\end{itemize}
\subsubsection{Wireless Security Tools and Hacking Countermeasures}
\begin{itemize}
    \item 
\end{itemize}


\subsection{Hacking Mobile Platforms}
\subsubsection{Mobile Platform Attack Vectors}
\begin{itemize}
    \item Which of the following categories of mobile risk covers “Security Decisions via Untrusted Inputs” and is one of the less frequently used categories?
    \begin{itemize}
        \item Client Code Quality
    \end{itemize}
    \item OWASP Top 10 Mobile Risk?
    \begin{enumerate}
        \item Improper platform usage
        \item Insecure data storage
        \item Insecure communication
        \item Insecure authentication
        \item Insufficient cryptography
        \item Insecure authorization
        \item Client code quality
        \item Code tampering
        \item Reverse engineering
        \item Extraneous functionality
    \end{enumerate}    
\end{itemize}
\subsubsection{Hacking Android OS}
\begin{itemize}
    \item
\end{itemize}
\subsubsection{Hacking iOS}
\begin{itemize}
    \item Which of the following statements is not true for securing iOS devices?
    \begin{itemize}
        \item Jailbreak detection has to be enabled all the time in any iOS device. Disabling Jailbreaking detection in the device cannot secure the device from jailbreaking and once if jailbreaking has been performed on the device, the device can be prone to installation of applications from any untrusted sources and can also lead to various attacks that can cause data theft.
    \end{itemize}
\end{itemize}
\subsubsection{Mobile Devices Management}
\begin{itemize}
    \item Which of the following is the correct BYOD security guideline that an employee should follow to secure sensitive personal or corporate information stored on a mobile device?
    \begin{itemize}
        \item Do not allow Jailbroken or rooted devices.
    \end{itemize}
    \item Which of the following is not a feature of Mobile Device Management Software?
    \begin{itemize}
        \item Sharing confidential data among devices and networks
    \end{itemize}
\end{itemize}
\subsubsection{Mobile Security Guidelines and Tools}
\begin{itemize}
    \item 
\end{itemize}


\subsection{IoT Attacks}
\subsection{IoT Countermeasures}
\begin{itemize}
    \item Which of the following practices helps security professionals in defending against IoT hacking?
    \begin{itemize}
        \item Monitor traffic on port 48101
    \end{itemize}
    \item Which of the following is a security consideration for the gateway component of IoT architecture?
    \begin{itemize}
        \item 
    \end{itemize}
\end{itemize}
\subsection{OT Concepts}
\begin{itemize}
    \item In which of the following attacks does an attacker use techniques such as timing analysis and power analysis to obtain critical information from a target industrial system?
    \begin{itemize}
        \item Side-Channel Attack
    \end{itemize}
\end{itemize}
\subsection{OT Hacking Methodology and Countermeasures}
\begin{itemize}
    \item Nmap commands used by attackers to enumerate open ports and services of ICS/SCADA systems:
    \begin{itemize}
        \item Identifying HMI systems: \verb|nmap -Pn -sT -p 46824 <TargetIP>|
        \item Scanning Siemens SIMATIC S7 PLCs: \verb|nmap -Pn -sT -p 102 --script s7-info <TargetIP>|
        \item Scanning Ethernet/IP Devices: \verb|nmap -Pn -sU 44818 --script enip-info <TargetIP>|
        \item Scanning Niagara Fox Devices: \verb|nmap -Pn -sT -p 1911,4911 --script fox-info <TargetIP>|
    \end{itemize}
\end{itemize}


\subsection{Cloud Computing}
\subsubsection{Cloud Computing Concepts}
\begin{itemize}
    \item 
\end{itemize}
\subsubsection{Container Technology and Serverless Computing}
\begin{itemize}
    \item Which of the following is the property of container technology that makes it less secure than vitual machines?
    \begin{tabular}[H]{|c|c|}
        \hline
        Virtual Machines & Containers\\
        \hline
        Heavyweight & Lightweight and portable\\
        \hline
        Run on independent operating systems & Share a single host operating system\\
        \hline
        Hardware-based virtualization & OS-based virtualization\\
        \hline
        Slower provisioning & Scalable and real-time provisioning\\
        \hline
        Limited performance & Native performance\\
        \hline 
        Completely isolated, making it more secure & Process-level isolation, partially secured\\
        \hline
        Created and launched in minutes & created and launched in seconds.\\
        \hline
    \end{tabular}
\end{itemize}
\subsubsection{Cloud Computing Threats}
\begin{itemize}
    \item In one of the following OWASP cloud security risks, unsecured data in transit are susceptible to eavesdropping and interception attacks. Which is this risk?
    \begin{itemize}
        \item Service and data integration
    \end{itemize}
    \item Which of the following is not a legitimate cloud computing attack?
    \begin{itemize}
        \item Port scanning is correct because it is not an attack. It is used in information gathering. DoS/privilege escalation/MiTM are legitimate attacks because they are generally performed with malice so as to cause damage or steal information from an organization.
    \end{itemize}
\end{itemize}
\subsubsection{Cloud Hacking}
\begin{itemize}
    \item Which of the following information can be enumerated when an attacker runs the command \begin{verbatim}
        ps -ef | grep apiserver
    \end{verbatim} in Kubernetes etcd?
    \begin{itemize}
        \item Location of the etcd server and PKI information
    \end{itemize}
    \item Which of the following is the docker command used by an attacker to create a container from an image to exploit the docker remote api?
    \begin{itemize}
        \item Get an image of Alpine Linux:\\
        \verb|docker -H <Remote IP:Port> pull alpine|
        \item Create a container from the image using the following command:\\
        \verb| docker -H <Remote IP:Port> run -t -d alpine|
        \item Run the ls command inside the container to retrieve files stored on the Docker host:\\
        \verb|docker -H <Remote IP:Port> exec modest_goldstine ls|
        \item Use Nmap to scan the host's internal network to identify running services:\\
        \verb|docker -H <docker host> run --network=host --rm marsmensch/nmap -ox <IP Range>|
        \item Retrieve MySQL database credentials?\\
        \verb|/|
        \item Steps to exploit misconfigured AWS S3 buckets:
        \begin{enumerate}
            \item Identify S3 buckets
            \item Setup the AWS command-line interface
            \item Extract access keys
            \item Configure aws-cli
            \item Identify vulnerable S3 buckets
            \item Exploit S3 buckets
        \end{enumerate}
        \item Steps to exploit AWS docker containers.
        \begin{enumerate}
            \item Abuse AWS credentials
            \item Pull the target Docker image
            \item Create a backdoor image
            \item Push the backdoor Docker image
        \end{enumerate}
    \end{itemize}
    \item In which of the following techniques does an attacker use lambda functions such as rabbit\_lambda, cli\_lambda, and backdoor\_created\_users\_lambda to install a backdoor to AWS infrastructure
    \begin{itemize}
        \item Manipulating access keys.
    \end{itemize}
\end{itemize}
\subsubsection{Cloud Security}
\begin{itemize}
    \item Best practices for securing Docker environment:
    \begin{itemize}
        \item Enable read-only mode on filesystems and volumes by setting the \verb|--read-onlyflag|.
        \item Limit resources such as memory, CPU, the maximum number of file descriptors, the maximum number of processes, and restarts to prevent DoS attacks.
        \item Avoid exposing the Docker daemon socket because it is the basic entry point for the Docker API.
        \item Always run Docker images with \verb|--security-opt=no-new-privileges| to prevent privilege escalation attacks using setuid or setgid binaries.
        \item Only use trusted Docker images because Docker images created by malicious users may be injected with backdoors.
        Regularly patch host OS and Docker with the latest security updates.
        \item Use tools such as InSpec and DevSec to detect Docker vulnerabilities.
    \end{itemize}
    \item Best practices for securing the Kubernetes environment:
    \begin{itemize}
        \item Use the copy-then-rename method for log rotation to ensure that logs are not lost when restarting the kubelet.
        \item Use kube-apiserver instances that maintain CRLs to check the presented certificates.
        \item Use offensive security certified professional stapling to check the revocation status of certificates.
        \item Use single encoding format for all configuration tasks because it supports centralized validation.
        Ensure proper validation of file contents and their path at every stage of processing.
        Avoid using legacy SSH tunnels because they do not perform proper validation of server IP addresses.
        Use secure TLS by default in development and production configurations to reduce vulnerabilities owing to misconfiguration.
    \end{itemize}
\end{itemize}

\subsection{General}
\begin{itemize}
    \item Where does Microsoft Windows store authentication credentials and passwords?
    \begin{enumerate}
        \item \verb|C:\windows\system32\config|
    \end{enumerate}
    \item What netstat command will you use if you want to display all connections and listening ports, with addresses and port numbers in numerical form?
    \begin{enumerate}
        \item \verb|netstat -an|
    \end{enumerate}
    \item What type of rootkit uses system-level calls to hide their existence?
    \begin{enumerate}
        \item Library Level rootkit (user-level), replaces or modifies the functionality of system calls to the operating system.
    \end{enumerate}
    \item \begin{tabular}[H]{|l|l|l|}
        \hline
        \textbf{Issue} & \textbf{Solution} & \textbf{Notest}\\
        \hline
        Telnet, rlogin & Secure Shell (SSH) or openSSH & Sends encrypted data and makes it difficult for an attacker to send correctly encrypted data if a session is hijacked.\\
        \hline
        Any remote connection & Virtual Private Network (VPN) & Implementing encrypting VPNs such as PPTP, layer 2 protocol tunneling (L2PT), and IPsec, for remote connections prevents session hijacking.\\
        \hline
        Server message Block (SMB) & SMB Signing & Improves the security of the SMB protocol and reduces the chances of session hijacking.\\
        \hline
        Hub Network & Switch network & Mitigates the risk of ARP spoofing and othe session hijacking attacks. 
    \end{tabular}
\end{itemize}